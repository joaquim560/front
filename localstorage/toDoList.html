<!DOCTYPE html>
<html lang="pt-br">
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta charset="UTF-8" />
    <title>Lista de Compras</title>
    <link rel="stylesheet" href="estilo.css">
  </head>
  <body>
    <header>
      <img src="carro.png" alt="carrinho de compra">
      <h1>Lista de Compras</h1>
    </header>
    <main>
      <section id="formulario">
        <input type='button'  value='Gravar Lista' id="gravar">
        <input type='button'  value='Recuperar Lista' id="recuperar">
        <input type='button'  value='Limpar' id="limpar">
        <br><br>
        <label for="produto">Produto:</label>
        <input type="text"  id="produto"><br><br>
        <label for="quantidade">Quantidade:</label>
        <input type="text"  id="quantidade"><br><br>
        <input type='button'  value='Adicionar Tarefa' id="adicionar"> <br><br >
      </section>
        <section id="lista">...</section>
    </main>
<footer>Rio Grande - 2025</footer>
    <script>
      document.querySelector('#adicionar').addEventListener('click', insereProduto);
      document.querySelector('#gravar').addEventListener('click', gravar);
      document.querySelector('#recuperar').addEventListener('click', recuperar);
      document.querySelector('#limpar').addEventListener('click', limpar);

      let toDoList=[]; //Variável com os dados da TODO list
      let toDoListOld=[]; //Variável com os dados da TODO list


      function mostra() {
        let valor = "<h3>Comprar</h3>";
        for (let i = 0; i < toDoList.length; i++) {
          valor += `
          <input type="checkbox" id="produto${i}" onclick ="excluirProduto(${i})">
          <label for="produto${i}">${toDoList[i].produto} .. ${toDoList[i].quantidade}</label><br>`;
        }
        valor+="<h3>Produtos comprados</h3>";
        for (let i = 0; i < toDoListOld.length; i++) {
          valor += `
          <input type="checkbox" id="produto${i}" onclick ="excluirProduto2(${i})">
          <label for="produto${i}">${toDoListOld[i].produto} ..${toDoListOld[i].quantidade}</label><br>`;
        }
        document.querySelector("#lista").innerHTML = valor;
      }

      // Inclui e exclui terefas no array toDoList
      function insereProduto() {
        toDoList.push( {
          produto:document.querySelector("#produto").value,
          quantidade:document.querySelector("#quantidade").value
        }
          
          );
        mostra();
      }
      function excluirProduto(num) {
        
        toDoListOld.push( 
          toDoList[num]
          
        );
        toDoList.splice(num, 1);
        mostra();
      }
      function excluirProduto2(num) {
        
        
        toDoListOld.splice(num, 1);
        mostra();
      }

      //Operações no localstorage
      function gravar ()
      {
        localStorage.setItem("lista",JSON.stringify(toDoList));
        localStorage.setItem("listaOld",JSON.stringify(toDoListOld));
      }
      function recuperar ()
      {
        toDoList=[];
        lista=localStorage.getItem("lista");
        if(lista){
          toDoList=JSON.parse(lista);
        }

        toDoListOld=[];
        listaOld=localStorage.getItem("listaOld");
        if(listaOld){
          toDoListOld=JSON.parse(listaOld);
        }
        mostra();
      }
      function limpar() {
         localStorage.removeItem('lista');
         localStorage.removeItem('listaOld');
         toDoList=[];
         mostra();
      } 
    </script>
  </body>
</html>
